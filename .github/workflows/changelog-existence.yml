# **what?**
# Checks that a file has been committed under the /.changes directory as a new CHANGELOG entry.
# Cannot check for a specific filename as it is dynamically generated by change type and timestamp.
#
# **why?**
# Ensure code changes are reflected in the CHANGELOG.
#
# **how?**
# This workflow cannot use any secrets since it runs for PRs from forked repos.
# By default, secrets are not passed to workflows running from a forked repo.
#
# **when?**
# This will run for all PRs going into main and *.latest under one of the following conditions:
#   - the PR is opened or reopened
#   - any label is added/removed to/from the PR
#   - a new commit is pushed to the branch
# This will not run if the 'Skip Changelog' label is present on the PR.

name: Check Changelog Entry
on:
  pull_request:
    types: [opened, reopened, labeled, unlabeled, synchronize]
  workflow_dispatch:
defaults:
  run:
    shell: bash
permissions:
  contents: read
  pull-requests: write
jobs:
  check-changelog-entry:
    uses: dbt-labs/actions/.github/workflows/changelog-existence.yml@main
    with:
      changelog_comment: "Thank you for your pull request! We could not find a changelog entry for this change. For details on how to document a change, see the [dbt-snowflake contributing guide](https://github.com/dbt-labs/dbt-snowflake/blob/main/CONTRIBUTING.md)."
      skip_label: "Skip Changelog"
    secrets: inherit # this is only acceptable because we own the action we're calling
